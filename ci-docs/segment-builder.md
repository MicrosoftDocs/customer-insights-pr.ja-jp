---
title: セグメント ビルダーを使用してセグメントを作成する
description: 顧客のセグメントを作成して、さまざまな属性に基づいてグループ化します。
ms.date: 03/25/2022
ms.subservice: audience-insights
ms.topic: how-to
author: JimsonChalissery
ms.author: jimsonc
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-segments
- ci-segment-builder
- ci-segment-details
- customerInsights
ms.openlocfilehash: e1a9cd0e3c0347285026d937ca7d951a602e7160
ms.sourcegitcommit: b515120bebd2638f2639004422cee3cff42fbdf7
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/24/2022
ms.locfileid: "8800102"
---
# <a name="create-segments"></a>セグメントの作成

統合された顧客エンティティとその関連エンティティに対して複雑なフィルターを定義します。 処理後の各セグメントには、エクスポートして操作できる顧客エンティティ レコードのセットが作成されます。 セグメントは、**セグメント** ページで管理されます。 アプリの他の領域からセグメント ビルダー または[クイック セグメントの作成](#quick-segments)を使用して[新規セグメントの作成](#create-a-new-segment)ができます。

> [!TIP]
> - クイック セグメントは、**個人の顧客** の環境でのみサポートされます。
> - **個人の顧客** に基づくセグメントには、セグメント メンバーの利用可能な取引先担当者情報が自動的に含まれます。 **ビジネス アカウント** の環境で、セグメントは取引先企業 (会社または子会社) に基づいています。 セグメントに取引先担当者情報を含めるには、セグメント ビルダーで **プロジェクトの属性** 機能を使用します。 連絡先データ ソースが、[ContactProfile に意味的にマップされる](semantic-mappings.md#define-a-contactprofile-semantic-entity-mapping) エンティティであることを確認します。

## <a name="segment-builder"></a>セグメント ビルダー

次の画像は、セグメント ビルダーのさまざまな側面を表わしています。 これは、顧客のグループとなるセグメントを示しています。 顧客は特定の概算時間で商品を注文し、報酬ポイントを集めるか、特定の金額を費やしました。

:::image type="content" source="media/segment-builder-overview.png" alt-text="セグメント ビルダーの要素。" lightbox="media/segment-builder-overview.png":::

1. ルールとサブルールを使用してセグメントを整理します。 各ルールまたはサブルールは条件で構成されます。 論理演算子で条件を組み合わせる

1. ルールに適用されるエンティティ間の[リレーション パス](relationships.md)を選択します。 リレーションシップ パスは、条件で使用できる属性を決定します。

1. ルールとサブルールを管理します。 ルールの位置を変更、または削除します。

1. 条件を追加し、サブルールを使用して適切なレベルのネストを構築します。

1. 接続されたルールにセット操作を適用します。

1. 属性ペインを使用して、利用可能なエンティティ属性の追加、属性に基づいた条件の作成をします。 ペインには、選択したリレーションシップ パスに基づいて、選択したルールで使用可能なエンティティと属性のリストが表示されます。

1. 既存のルールやサブルールに属性に基づく条件を追加したり、新しいルールに追加したりすることができます。

1. セグメントの構築中に変更の取消や、やり直しができます。

上記の例は、セグメント化機能を示しています。 オンラインで 500 ドル以上の商品を購入し、*かつ* ソフトウェア開発に興味を持っている顧客を対象としたセグメントを設定しました。

## <a name="create-a-new-segment"></a>新しいセグメントの作成

新しいセグメントを作成するには、複数の方法があります。 このセクションでは、ユーザー独自のセグメントを最初から作成する方法について説明します。 既存のエンティティに基づいて *クイック セグメント* を作成したり、機械学習モデルを使用して *提案されたセグメント* を取得することもできます。 詳細については、[セグメントの概要](segments.md)を参照してください。

セグメントの作成中に、下書きを保存できます。 ドラフト段階では、セグメントは非アクティブなセグメントとして保存されます。 セグメント構成が完了したら、それを実行してセグメントをアクティブ化します。 **すべてのセグメント** ページから、セグメントを **アクティブ化** することもできます。

1. **セグメント** ページを表示します。

1. **新規** > **ユーザー独自の作成** を選択します。

1. セグメント ビルダー ページで、ルールを定義または作成します。 ルールは、顧客のセットを定義する 1 つ以上の条件で構成されます。

1. **Rule1** セクションで、顧客をフィルタリングするエンティティの属性を選択します。 属性の選択には、次の 2 つの方法があります:
   - **ルールに追加** ペインで利用可能なエンティティと属性のリストを確認し、追加する属性の横にある **+** アイコンを選択します。 既存のルールに属性を追加するか、新規ルールの作成に使用するかを選択します。
   - ルール セクションに属性の名前を入力して、一致する提案を表示します。

1. 演算子を選択して、条件の一致する値を指定します。 属性の値には、数値、文字列、日付、ブール値の 4 つのデータ型のいずれかを持つことができます。 属性のデータ型に応じて、さまざまな演算子を使用して条件を指定できます。 ビジネス アカウントを持つセグメントの場合、取り込んだアカウント間の潜在的な階層を含めるために、2 つの特別な演算子を使用できます。 演算子の *子* と *親* を使って、関連するアカウントを含めます。

1. **条件の追加** を選択して、ルールに条件を追加します。 現在のルールの配下にルールを作成するには、**サブ ルールの追加** を選択します。

1. ルールで *顧客* エンティティ以外のエンティティを使用する場合は、リレーションシップ パスを設定する必要があります。 リレーションシップ パスは、統合された顧客エンティティにアクセスする関連付けをシステムに通知するために必要となります。 **リレーションシップ パスの設定** を選択し、エンティティを統合された顧客エンティティにマップします。 可能なリレーションシップ パスが 1 つしかない場合、システムはそれを自動的に選択します。 リレーションシップ パスが異なれば、結果も異なる可能性があります。 すべてのルールは、独自のリレーションシップ パスがを持つことができます。

   :::image type="content" source="media/relationship-path.png" alt-text="統合された顧客エンティティにマッピングされたエンティティに基づいてルールを作成する場合の潜在的なリレーションシップ パス。":::

   たとえば、スクリーンショットの *eCommerce_eCommercePurchases* エンティティには、*顧客* エンティティにマッピングする 4 つのオプションがあります:
   - eCommerce_eCommercePurchases > eCommerce_eCommerceContacts > 顧客
   - eCommerce_eCommercePurchases > 顧客
   - eCommerce_eCommercePurchases > eCommerce_eCommerceContacts > POS_posPurchases > 顧客
   - eCommerce_eCommercePurchases > eCommerce_eCommerceContacts > POS_posPurchases > loyaltyScheme_loyCustomers > Customer 最後のオプションを選択すると、リストアップされたすべてのエンティティの属性をルール条件に含めることができます。 一致する顧客レコードはすべてのエンティティの一部である必要があるため、結果が少なくなる可能性があります。 この例では、電子商取引 (*eCommerce_eCommercePurchases*) を通じて販売時点管理 (*POS_posPurchases*) で商品を購入し、当社のロイヤルティ プログラム (*loyaltyScheme_loyCustomers*) に参加する必要があります。 2 番目のオプションを選択する際には、属性は *eCommerce_eCommercePurchases* エンティティと *顧客* エンティティからのみ選択可能です。 これにより、結果として得られる顧客プロファイルが増える可能性があります。

1. ルールに複数の条件がある場合、それらを接続する論理演算子を選択できます。  
   - **AND** 演算子: セグメントにレコードを含めるには、すべての条件を満たす必要があります。 このオプションは、異なるエンティティにわたって条件を定義するときに最も役立ちます。
   - **OR** 演算子: セグメントにレコードを含めるには、いずれかの条件を満たす必要があります。 このオプションは、同じエンティティにわたって複数の条件を定義するときに最も役立ちます。

   :::image type="content" source="media/segmentation-either-condition.png" alt-text="2 つの AND 条件で実行するルール。":::

   OR 演算子を使用する場合は、すべての条件がリレーションシップ パスに含まれるエンティティに基づいている必要があります。

   - 複数のルールを作成して、さまざまな顧客レコードのセットを作成可能です。 グループを連結して、ビジネス案件に必要な顧客を含めることができます。 新しいルールを作成するには、**ルールの追加** を選択します。 具体的には、関係パスが指定されているためにルールにエンティティを含めることができない場合は、新しいルールを作成して、そのルールから属性を選択する必要があります。

      :::image type="content" source="media/segment-rule-grouping.png" alt-text="セグメントに新しいルールを追加し、演算子を選択します。":::

   - 集合演算子 (**結合**、**交差**、**例外**) のいずれかを選択します。

      - **結合** は 2 つのグループを結合します。
      - **交差** は 2 つのグループが重複しています。 両方のグループに *共通する* データのみが、統合グループで残ります。
      - **例外** は 2 つのグループを結合します。 グループ B のデータでは *一般的ではない* グループのデータのみが、保持されます。

1. 既定では、セグメントは定義されたフィルターに一致する顧客プロファイルのすべての属性を含む出力エンティティを生成します。 セグメントが *Customer* エンティティ以外の他のエンティティに基づいている場合は、これらのエンティティから出力エンティティに属性を追加できます。 **プロジェクトの属性** を選択して、出力エンティティに追加する属性を選択します。

   > [!IMPORTANT]
   > ビジネス アカウントに基づくセグメントの場合、*ContactProfile* エンティティからの各取引先企業の 1 つ以上の取引先担当者の詳細をセグメントに含めて、そのセグメントをアクティブ化するか、取引先担当者情報が必要な宛先にエクスポートできるようにする必要があります。 *ContactProfile* エンティティの詳細は、[セマンティック マッピング](semantic-mappings.md) を参照してください。
   > 連絡先の属性が予測されたビジネス アカウントに基づくセグメントの出力例は、次のようになります。
   >
   > |ID  |アカウント名  |売上  |取引先担当者名  | 取引先担当者ロール|
   > |---------|---------|---------|---------|---|
   > |10021     | Contoso | 100K | [アビー モス、ルース ソト]  | [CEO、調達マネージャー]

   :::image type="content" source="media/segments-project-attributes.png" alt-text="サイド ペインで選択した属性を出力エンティティに追加して投影した例。":::
  
   例: セグメントは、*Customer* エンティティに関連する購入データを含むエンティティに基づいています。 このセグメントでは、今年商品を購入したスペインの全顧客を検索します。 商品の価格や購入日などの属性を、出力エンティティの一致するすべての顧客レコードに付加することができます。 この情報は、総支出に対する季節的な相関関係の分析に役立つかもしれません。

   > [!NOTE]
   > - **プロジェクトの属性** は、顧客エンティティと 1 対多の関係にあるエンティティに対してのみ機能します。 たとえば、1 人の顧客が複数のサブスクリプションを持つことができます。
   > - リレーションシップで定義されているように、投影する属性が *Customer* エンティティから 1 ホップより多く離れている場合、その属性は、構築するセグメント クエリのすべてのルールで使用する必要があります。
   > - 投影する属性が *Customer* エンティティから 1 ホップだけ離れている場合、その属性は、構築するセグメント クエリのすべてのルールに存在する必要はありません。
   > - **予測した属性** は、集合演算子の使用時に考慮されます。

1. 無題のセグメントの横にある **詳細の編集** を選択します。 セグメントの名前を入力し、セグメントの推奨 **出力エンティティ名** を更新します。 必要に応じて、説明と[タグ](work-with-tags-columns.md#manage-tags)をセグメントに追加します。

   :::image type="content" source="media/segments_edit_details.png" alt-text="[詳細の編集] ダイアログ ボックス。":::

1. **実行** を選択して、セグメントを保存し、セグメントをアクティブにして、すべてのルールと条件に基づいてセグメントの処理を開始します。 それ以外の場合は、非アクティブなセグメントとして保存されます。

1. **セグメントに戻る** を選択して、**セグメント** のページに戻ります。

1. 既定では、セグメントは動的セグメントとして作成されます。 これは、システムの更新中にセグメントが更新されることを意味します。 [自動更新を停止](segments.md#manage-existing-segments) を実行し、セグメントを選び、**静的にする** オプションを選択します。 静的セグメントは、いつでも[自動的に更新](segments.md#refresh-segments) が可能です。

> [!TIP]
> - セグメント ビルダでは、条件の演算子の設定時にエンティティの有効な値を提案しません。 **データ** > **エンティティ** にアクセスして、エンティティ データをダウンロードして、使用可能な値を確認します。
> - 日付に基づく条件を使用すると、固定日付と変動日付範囲を切り替えることができます。
> - セグメントに複数のルールがある場合、編集しているルールの横に青い縦線が表示されます。
> - ルールと条件は、セグメント定義の他の場所に移動できます。 ルールや条件の横にある垂直の省略記号 (&vellip;) を選択し、それを移動する方法と場所を選択します。
> - コマンドバーの **元に戻す** と **やり直し** コントロールを使用すると、変更をロールバックできます。
> - セグメントの作成後、一部のセグメントでは [セグメントの使用状況を追跡](segments.md#track-usage-of-a-segment) できます。

## <a name="quick-segments"></a>簡易セグメント

クイック セグメントでは、1 つの演算子で簡単なセグメントをすばやく作成して、より迅速なインサイトを得ることができます。

1. **セグメント** ページで、**新規** > **作成元** を選択します。
   - **プロファイル** オプションを選択して、*統合された顧客* エンティティに基づくセグメントを構築します。
   - **メジャー** オプションを選択して、以前に作成したメジャーに対してセグメントを構築します。
   - **インテリジェンス** オプションを選択して、**予測** または **カスタム モデル** 機能のいずれかを使用して生成した出力エンティティの 1 つにセグメントを構築します。

2. **新規簡易セグメント** ダイアログ ボックスで、**フィールド** ドロップダウンから属性を選択します。

3. このシステムにより、多くの分析情報が提供されるため、顧客の良質なセグメントを作ることができます。
   - カテゴリ フィールドに対しては、上位 10 件の顧客数が表示されます。 **値** を選択して、**レビュー** を選択します。
   - 数値属性の場合、システムは各顧客のパーセンタイルに該当する属性値を表示します。 **演算子** と **値** を選択して、次に **レビュー** を選択します。

4. システムは、**推定セグメント サイズ** を提供します。 定義したセグメントを生成するか、最初に再訪して別のセグメント サイズを取得するかを選択できます。

   :::image type="content" source="media/quick-segment-name.png" alt-text="クイック セグメントの名前と見積もり。":::

5. セグメントに **名前** と **出力エンティティ名** を指定します。 必要に応じて、[タグ](work-with-tags-columns.md#manage-tags)を追加します。

6. **保存** を選択して、セグメントを作成します。

7. セグメントの処理が完了すると、作成した他のセグメントと同様に表示できます。

## <a name="next-steps"></a>次のステップ

[セグメントをエクスポート](export-destinations.md)して、[カスタマー カードとの統合](customer-card-add-in.md)を確認し、他のアプリケーションでセグメントを使用することができます。

[!INCLUDE [footer-include](includes/footer-banner.md)]
