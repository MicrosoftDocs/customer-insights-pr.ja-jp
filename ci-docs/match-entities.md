---
title: データ統合の一致条件
description: データを照合して、統合顧客プロファイルを作成します。
recommendations: false
ms.date: 05/05/2022
ms.subservice: audience-insights
ms.topic: tutorial
author: v-wendysmith
ms.author: mukeshpo
ms.reviewer: v-wendysmith
manager: shellyha
searchScope:
- ci-match
- ci-merge
- ci-map
- customerInsights
ms.openlocfilehash: 770a18f3a7471714a7e044ae034da168a2601010
ms.sourcegitcommit: dca46afb9e23ba87a0ff59a1776c1d139e209a32
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/29/2022
ms.locfileid: "9081370"
---
# <a name="match-conditions-for-data-unification"></a>データ統合の一致条件

[!INCLUDE [m3-prod-trial-note](includes/m3-prod-trial-note.md)]

統合のこの手順では、エンティティ間の一致の一致順序とルールを定義します。 この手順には、少なくとも 2 つのエンティティが必要です。

> [!NOTE]
> 一致条件を作成して **次へ** を選択すると、選択したエンティティまたは属性を削除できなくなります。 必要に応じて、**戻る** を選択して、続行する前に選択したエンティティと属性を確認します。

## <a name="include-enriched-entities-preview"></a>エンリッチされたエンティティを含む (プレビュー)

統合結果を改善するためにデータ ソース レベルでエンティティをエンリッチした場合は、それらを選択します。 詳細については、[データ ソースのエンリッチメント](data-sources-enrichment.md) を参照してください。 **重複レコード** ページでエンリッチされたエンティティを選択した場合は、それらを再度選択する必要はありません。

1. **一致条件** ページで、ページの上部にある **エンリッチされたエンティティを使用する** を選択します。

1. **エンリッチされたエンティティを使用** ペインから、1 つ以上のエンリッチされたエンティティを選択します。

1. **完了** を選択します。

## <a name="specify-the-match-order"></a>一致順を指定します。

各照合では、2 つ以上のエンティティを単一の連結エンティティに統合します。 同時に、一意の顧客レコードを保持します。 照合順序はシステムがレコードの照合を行う順序を示します。

> [!IMPORTANT]
> リストの最初のエンティティは、主エンティティと呼ばれます。 主エンティティは、統合プロファイル データセットの基盤として機能します。 選択された追加のエンティティがこのエンティティに追加されます。
>
> 重要な考慮事項:
>
> - 主エンティティとして、顧客に関する最も完全で信頼性の高いプロファイル データを含むエンティティを選択します。
> - 他のエンティティと共通の属性 (名前、電話番号、メールアドレスなど) をいくつか持つエンティティを、主エンティティとして選択します。

1. **一致条件** ページで、上下の移動矢印を使用してエンティティを目的の順序で移動するか、ドラッグ アンド ドロップします。 たとえば、主エンティティとして **Contacts:eCommerce** を選択し、2 番目のエンティティとして **CustomerLoyalty:Loyalty** を選択します。

1. 一致するものが見つかったかどうかに関係なく、エンティティ内のすべてのレコードを一意の顧客として保持するには、**すべてのレコードを含める** を選択します。 他のエンティティのレコードと一致しないこのエンティティのレコードは、統合プロファイルに含まれます。 一致しないレコードはシングルトンと呼ばれます。
  
主エンティティ *Contacts:eCommerce* は次のエンティティ *CustomerLoyalty:Loyalty* と一致します。 3 つ以上のエンティティがある場合、最初の照合ステップの結果であるデータセットは、次のエンティティと一致します。

:::image type="content" source="media/m3_match.png" alt-text="エンティティに対して選択された一致順序のスクリーンショット。" lightbox="media/m3_match.png":::

## <a name="define-rules-for-match-pairs"></a>照合ペアのルールを定義する

一致ルールは、エンティティの特定のペアが一致するロジックを指定します。 ルールは、1 つ以上の条件で構成されます。

エンティティ名の横にある警告は、一致ペアに対して一致ルールが定義されていないことを意味します。

1. 一致ルールを定義するには、エンティティ ペアに対して **ルールの追加** を選択します。

1. **ルールの追加** ウインドウで、ルールの条件を構成します。

   :::image type="content" source="media/m3_add_rule.png" alt-text="ルールの追加ウィンドウのスクリーンショット。":::

   - **エンティティ/フィールド (最初の行) を選択します**: 関連するエンティティと属性を選択して、顧客に固有である可能性が高いレコード プロパティを指定します。 たとえば、電話番号や電子メール アドレスなどです。 アクティビティ タイプの属性による照合は避けてください。 たとえば、購入 ID は、他のレコードの種類では一致しない可能性があります。

   - **エンティティ/フィールド (2 行目) を選択します**: 最初の行で指定されたエンティティの属性に関連する属性を選択します。

   - **正規化**: 選択された属性について、次の正規化オプションから選択します。
     - **数字**: ローマ数字などの他の数字システムをアラビア数字に変換します。 *VIII* は *8* になります。
     - **記号**: すべての記号と特殊文字を削除します。 *Head&Shoulder* は *HeadShoulder* になります。
     - **テキストを小文字に**: すべての文字を小文字に変換します。 *ALL CAPS and Title Case* は *all caps and title case* になります。
     - **タイプ (電話、名前、住所、組織)**: 名前、役職、電話番号、住所および組織を標準化します。
     - **Unicode から ASCII へ**: Unicode 表記を ASCII 文字に変換します。 */u00B2* は *2* になります。
     - **空白**: すべてのスペースを削除します。 *Hello   World* は、*HelloWorld* になります。

   - **精度**: この条件に適用する精度のレベルを設定します。
     - **基本**: *低 (30%)*、*中 (60%)*、*高 (80%)*、*完全一致t (100%)* から選択します。 100％一致するレコードのみを一致とする場合は **完全一致** を選択します。
     - **カスタム**: レコードが一致する必要がある割合を設定します。 システムは、このしきい値を超えるレコードのみを照合します。

   - **名前**: ルールの名前です。

1. 属性が複数の条件を満たす場合にのみエンティティを一致させるには、**追加** > **条件の追加** を選択して、一致ルールにさらに条件を追加します。 条件は論理 AND 演算子で接続されるため、すべての条件が満たされた場合にのみ実行されます。

1. 必要に応じて、[例外](#add-exceptions-to-a-rule) または[カスタム一致条件](#specify-custom-match-conditions) などの高度なオプションを検討してください。

1. **完了** を選択してルールを終了します。

1. オプションで、[ルールをさらに追加](#add-rules-to-a-match-pair) します。

1. **次へ** をクリックします。

> [!div class="nextstepaction"]
> [次の手順: フィールドを統合する](merge-entities.md)

### <a name="add-rules-to-a-match-pair"></a>照合ペアにルールを追加する

照合ルールは条件セットを表します。 複数の属性に基づく条件によってエンティティを照合する場合は、ルールをさらに追加します。

1. ルールを追加するエンティティで **ルールの追加** を選択します。

1. [照合ペアのルールを定義する](#define-rules-for-match-pairs) の手順に従います。

> [!NOTE]
> ルールの順序は重要です。 照合アルゴリズムは、最初のルールに基づいて特定の顧客レコードを一致しようと試み、最初のルールで一致が識別されなかった場合にのみ 2 番目のルールに進みます。

## <a name="advanced-options"></a>詳細オプション

### <a name="add-exceptions-to-a-rule"></a>ルールに例外を追加する

ほとんどの場合、エンティティの照合により、統合されたデータを持つ一意の顧客プロファイルが作成されます。 偽陽性や偽陰性のまれなケースに動的に対処するために、照合ルールの例外を定義できます。 例外は、照合ルールの処理後に適用され、例外条件を満たすレコードすべての照合を回避します。

たとえば、照合ルールが姓、都市、および生年月日を組み合わせている場合、システムは、同じプロファイルと同じ町に住んでいる同じ姓を持つ双子を識別します。 結合するエンティティの名が同じでない場合は、プロファイルに一致しない例外を指定できます。

1. **ルールの編集** ウィンドウで、**追加** > **例外の追加** を選択します。

1. 例外条件を指定します。

1. **完了** を選択して、ルールを保存します。

### <a name="specify-custom-match-conditions"></a>カスタム照合条件の指定

既定の照合ロジックをオーバーライドする条件を指定できます。 次の 4 つのオプションを使用できます。

|回答内容  |Description |例  |
|---------|---------|---------|
|常に照合する     | 常に一致する値を定義します。         |  *Mike* と *MikeR* は常に一致します。       |
|照合しない     | 常に一致しない値を定義します。        | *John* と *Jonathan* は常に一致しません。        |
|カスタムのバイパス     | システムが照合フェーズで常に無視するべき値を定義します。 |  照合中に *11111* と *Unknown* の値を無視します。        |
|エイリアス マッピング    | システムが同じ値と見なすべき値を定義します。         | *Joe* が *Joseph* と等しいと見なします。        |

1. **カスタム** を選択します。

   :::image type="content" source="media/m3_match_custom.png" alt-text="カスタム ボタン":::

1. **カスタム タイプ** を選択し、**テンプレートのダウンロード** を選択します。 照合オプションごとに個別のテンプレートが必要です。

1. ダウンロードしたテンプレート ファイルを開き、詳細を入力します。 テンプレートには、カスタム照合で使用されるエンティティとエンティティの主キーの値を指定するフィールドが含まれています。 たとえば、*Sales* エンティティの主キー *12345* を *Contact* エンティティの主キー *34567* と常に一致させる場合は、テンプレートに次のように入力します:
    - Entity1: Sales
    - Entity1Key: 12345
    - Entity2: Contact
    - Entity2Key: 34567

   同じテンプレート ファイルで、複数のエンティティからカスタム一致レコードを指定できます。

   エンティティの重複排除にカスタム照合を指定する場合は、Entity1 とEntity2 の両方と同じエンティティを指定し、異なる主キー値を設定します。

1. オーバーライドをすべて追加してからテンプレート ファイルを保存します。

1. **データ** > **データ ソース** に移動し、テンプレート ファイルを新しいエンティティとして取り込みます。

1. ファイルをアップロードした後、**カスタム** オプションを再度選択します。 ドロップダウン メニューから必要なエンティティを選択し、**完了** を選択します。

   :::image type="content" source="media/custom-match-overrides.png" alt-text="カスタム照合シナリオに対する上書きを選択するダイアログのスクリーンショット。":::

1. 使用する照合オプションにより、カスタム照合の適用が異なります。

   - **常に一致** または **常に不一致** の場合は次のステップに進みます。
   - **バイパス** または **エイリアス マッピング** の場合は、既存の照合ルールで **編集** を選択するか、新しいルールを作成します。 正規化ドロップダウンから **カスタム バイパス** または **エイリアス マッピング** オプションを選択してから、**完了** を選択します。

1. **カスタム** ウィンドウで **完了** を選択して、カスタム一致構成を適用します。

> [!div class="nextstepaction"]
> [次の手順: フィールドを統合する](merge-entities.md)

[!INCLUDE [footer-include](includes/footer-banner.md)]
