---
title: Machine Learning Studio (クラシック) の実験
description: Dynamics 365 Customer Insights で Machine Learning Studio (クラシック) モデルを使用します。
ms.date: 12/03/2020
ms.service: customer-insights
ms.subservice: audience-insights
ms.topic: conceptual
author: m-hartmann
ms.author: mhart
ms.reviewer: ameetj
manager: shellyha
ms.openlocfilehash: 556b6810db0ed2733a3f086291757bd85b77e371
ms.sourcegitcommit: a9b2cf598f256d07a48bba8617347ee90024a1dd
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/03/2020
ms.locfileid: "4669024"
---
# <a name="use-models-based-on-azure-machine-learning-studio-classic"></a><span data-ttu-id="e13aa-103">Azure Machine Learning Studio (クラシック) に基づくモデルを使用する</span><span class="sxs-lookup"><span data-stu-id="e13aa-103">Use models based on Azure Machine Learning Studio (classic)</span></span>

<span data-ttu-id="e13aa-104">Dynamics 365 Customer Insights の統合データは、追加のビジネス インサイトを生成できる機械学習モデルを構築するためのソースです。</span><span class="sxs-lookup"><span data-stu-id="e13aa-104">The unified data in Dynamics 365 Customer Insights is a source for building machine learning models that can generate additional business insights.</span></span> <span data-ttu-id="e13aa-105">Customer Insights は、Machine Learning Studio (クラシック) と統合して、独自のカスタム モデルを使用します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-105">Customer Insights integrates with Machine Learning Studio (classic) to use your own custom models.</span></span> <span data-ttu-id="e13aa-106">Azure Machine Learning で開発されたモデルが Customer Insights とどのように統合されているかを確認するには、[Azure Machine Learning の実験](azure-machine-learning-experiments.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e13aa-106">To see how models developed in Azure Machine Learning are integrated with Customer Insights, see [Azure Machine Learning experiments](azure-machine-learning-experiments.md).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="e13aa-107">前提条件</span><span class="sxs-lookup"><span data-stu-id="e13aa-107">Prerequisites</span></span>

- <span data-ttu-id="e13aa-108">Customer Insights を使用する</span><span class="sxs-lookup"><span data-stu-id="e13aa-108">Access to Customer Insights</span></span>
- <span data-ttu-id="e13aa-109">アクティブな Azure Enterprise のサブスクリプション</span><span class="sxs-lookup"><span data-stu-id="e13aa-109">Active Azure Enterprise subscription</span></span>
- [<span data-ttu-id="e13aa-110">統合顧客プロファイル</span><span class="sxs-lookup"><span data-stu-id="e13aa-110">Unified customer profiles</span></span>](data-unification.md)
- <span data-ttu-id="e13aa-111">[Azure Blob Storage へのエンティティのエクスポート](export-azure-blob-storage.md)の設定</span><span class="sxs-lookup"><span data-stu-id="e13aa-111">[Entity export to Azure Blob storage](export-azure-blob-storage.md) set up</span></span>

## <a name="set-up-machine-learning-studio-classic"></a><span data-ttu-id="e13aa-112">Machine Learning Studio クラシックの設定</span><span class="sxs-lookup"><span data-stu-id="e13aa-112">Set up Machine Learning Studio Classic</span></span>

<span data-ttu-id="e13aa-113">最初のステップでは、Machine Learning Studio (クラシック) のワークスペースを作成して開く必要があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-113">In a first step, we need to create a workspace for and open the Machine Learning Studio (classic).</span></span>

1. <span data-ttu-id="e13aa-114">[https://www.portal.azure.com](https://www.portal.azure.com/) に移動してサインインします。</span><span class="sxs-lookup"><span data-stu-id="e13aa-114">Go to [https://www.portal.azure.com](https://www.portal.azure.com/) and sign in.</span></span>

1. <span data-ttu-id="e13aa-115">**リソースの作成** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-115">Select **Create a resource**.</span></span>

1. <span data-ttu-id="e13aa-116">**Machine Learning Studio ワークスペース** を選択し、**作成** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-116">Search **Machine Learning Studio Workspace** and select **Create**.</span></span>

1. <span data-ttu-id="e13aa-117">必要な詳細を入力して[ワークスペースを作成します](https://docs.microsoft.com/azure/machine-learning/studio/create-workspace)。</span><span class="sxs-lookup"><span data-stu-id="e13aa-117">Enter the required details to [create the workspace](https://docs.microsoft.com/azure/machine-learning/studio/create-workspace).</span></span> <span data-ttu-id="e13aa-118">インポートする予定のデータの量に基づき、**Web サービス プランの価格レベル** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-118">Choose the **Web service plan pricing tier** based on the amount of data you plan to import.</span></span> <span data-ttu-id="e13aa-119">最良のパフォーマンスを得るために、地理的に最も近い **場所** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-119">For best performance, select the **Location** that is geographically closest to you.</span></span>

1. <span data-ttu-id="e13aa-120">リソースを作成すると、Machine Learning Studio ワークスペースのダッシュボードが表示されます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-120">After creating the resource, the Machine Learning Studio workspace dashboard will appear.</span></span> <span data-ttu-id="e13aa-121">**Machine Learning Studio** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-121">Select **Launch Machine Learning Studio**.</span></span>

   ![Azure Machine Learning Studio ユーザー インターフェイス](media/azure-machine-learning-studio.png)

## <a name="work-with-azure-machine-learning-studio"></a><span data-ttu-id="e13aa-123">Azure Machine Learning Studio で作業する</span><span class="sxs-lookup"><span data-stu-id="e13aa-123">Work with Azure Machine Learning Studio</span></span>

<span data-ttu-id="e13aa-124">これで、新たな実験を作成したり、サンプル ギャラリーから既存の実験テンプレートをインポートしたりできます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-124">You can now create a new experiment, or import an existing experiment template from the sample gallery.</span></span> <span data-ttu-id="e13aa-125">3 つの標準シナリオのサンプル実験があります:</span><span class="sxs-lookup"><span data-stu-id="e13aa-125">There are sample experiments for three standard scenarios:</span></span>

- [<span data-ttu-id="e13aa-126">チャーン予測</span><span class="sxs-lookup"><span data-stu-id="e13aa-126">Churn prediction</span></span>](#churn-analysis)

- [<span data-ttu-id="e13aa-127">顧客の生涯価値</span><span class="sxs-lookup"><span data-stu-id="e13aa-127">Customer lifetime value</span></span>](#customer-lifetime-value-prediction)

- [<span data-ttu-id="e13aa-128">製品の推奨または次善の策</span><span class="sxs-lookup"><span data-stu-id="e13aa-128">Product recommendation or next best action</span></span>](#productrecommendation-or-next-best-action)

1. <span data-ttu-id="e13aa-129">新たな実験を作成するか、ギャラリーから実験のテンプレートを使用する場合は、**データをインポートする** プロパティを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-129">If you create a new experiment or use an experiment template from the gallery, you need to configure the **Import Data** properties.</span></span> <span data-ttu-id="e13aa-130">ガイド付きエクスペリエンスを使用するか、詳細を直接入力して、データを含む Azure Blob Storage にアクセスします。</span><span class="sxs-lookup"><span data-stu-id="e13aa-130">Use the guided experience or directly provide details to access the Azure Blob Storage that contains your data.</span></span>  

   ![Azure Machine Learning Studio で実験する](media/azure-machine-learning-studio-experiment.png)

1. <span data-ttu-id="e13aa-132">ここまでの手順で、カスタム処理パイプラインを構築して、データのクリーンアップと前処理、機能の抽出、適切なモデルのトレーニングを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-132">Now you can build a custom processing pipeline to clean and preprocess the data, extract features, and train a suitable model.</span></span>

1. <span data-ttu-id="e13aa-133">モデルの性能をテストし、最適化します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-133">Test and optimize the model performance.</span></span>

1. <span data-ttu-id="e13aa-134">モデルの品質が満足いくものであれば、**Webサービスを設定する** > **予測 Web サービス** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-134">When you’re satisfied with the quality of a model, select **Set up web service** > **Predictive Web Service**.</span></span> <span data-ttu-id="e13aa-135">このオプションは、トレーニング済みのモデルと機能化パイプラインをトレーニング実験から予測サービスにインポートします。</span><span class="sxs-lookup"><span data-stu-id="e13aa-135">This option imports the trained model and the featurization pipeline from the training experiment to a predictive service.</span></span> <span data-ttu-id="e13aa-136">予測サービスは、予測を行うためにトレーニングの実験で使用されたスキーマを使用して、別の入力データのセットを取得することができます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-136">The predictive service can take another set of input data with the schema used in the training experiment to make predictions.</span></span>

   ![予測 Web サービスを設定する](media/predictive-webservice-control.png)

1. <span data-ttu-id="e13aa-138">予測 Web サービスの実験が成功したら、自動スケジューリング用にデプロイすることができます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-138">Once the predictive web service experiment is successful, you can deploy it for auto scheduling.</span></span> <span data-ttu-id="e13aa-139">Web サービスを Customer Insights と連携させるには、**Web サービスのデプロイ** > **Web サービスのデプロイ [新規] プレビュー** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-139">To have the web service work with Customer Insights, select **Deploy Web Service** > **Deploy Web Service [New] Preview**.</span></span> <span data-ttu-id="e13aa-140">[Web サービスのデプロイの詳細](https://docs.microsoft.com/azure/machine-learning/studio/deploy-a-machine-learning-web-service)。</span><span class="sxs-lookup"><span data-stu-id="e13aa-140">[Learn more about deploying a web service](https://docs.microsoft.com/azure/machine-learning/studio/deploy-a-machine-learning-web-service).</span></span>

   ![予測 Web サービスをデプロイする](media/predictive-webservice-deploy.png)

## <a name="sample-models-from-the-gallery"></a><span data-ttu-id="e13aa-142">ギャラリーのサンプル モデル</span><span class="sxs-lookup"><span data-stu-id="e13aa-142">Sample models from the gallery</span></span>

<span data-ttu-id="e13aa-143">この記事のモデルでは、Contoso Hotel の架空のシナリオを使用しています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-143">We'll use a fictitious scenario of Contoso Hotel for the models in this article.</span></span> <span data-ttu-id="e13aa-144">Contoso Hotel は次のデータを収集します :</span><span class="sxs-lookup"><span data-stu-id="e13aa-144">Contoso Hotel gathers the following data:</span></span>

- <span data-ttu-id="e13aa-145">ホテルの滞在活動で構成される CRM データ。</span><span class="sxs-lookup"><span data-stu-id="e13aa-145">CRM data consisting of hotel stay activity.</span></span> <span data-ttu-id="e13aa-146">データセットには、登録されている顧客ごとの宿泊日に関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-146">The data set includes information about the dates of stay for each registered customer.</span></span> <span data-ttu-id="e13aa-147">また、予約情報、部屋タイプ、支出の詳細などに関する詳細も含まれています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-147">It also contains information about the booking, room types, details of spend, and so on.</span></span> <span data-ttu-id="e13aa-148">データは、2014 年 1 月から 2018 年 1 月までの 4 年間です。</span><span class="sxs-lookup"><span data-stu-id="e13aa-148">The data spans four years, from January 2014 to January 2018.</span></span>
- <span data-ttu-id="e13aa-149">ホテルのゲストの顧客プロファイル。</span><span class="sxs-lookup"><span data-stu-id="e13aa-149">Customer profiles of hotel guests.</span></span> <span data-ttu-id="e13aa-150">これらのプロファイルには、名前、生年月日、住所、性別、電話番号など、それぞれの顧客に関する情報が含まれています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-150">These profiles contain information about each customer, including their name, birthdate, postal address, gender, and phone number.</span></span>
- <span data-ttu-id="e13aa-151">スパ、ランドリー、Wi-Fi、宅配便など、ホテルが提供するサービスの使用率。</span><span class="sxs-lookup"><span data-stu-id="e13aa-151">Usage of services offered by the hotel, such as the spa, laundry, WiFi, or courier.</span></span> <span data-ttu-id="e13aa-152">この情報は、登録された顧客ごとに記録されます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-152">This information is logged for each registered customer.</span></span> <span data-ttu-id="e13aa-153">通常、サービスの用は宿泊と連動しています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-153">Typically, use of services is linked with the stay.</span></span> <span data-ttu-id="e13aa-154">ホテルに宿泊なくても、顧客がサービスを利用できる場合があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-154">In some cases, services can be used by customers without staying in the hotel.</span></span>

## <a name="churn-analysis"></a><span data-ttu-id="e13aa-155">チャーン分析</span><span class="sxs-lookup"><span data-stu-id="e13aa-155">Churn Analysis</span></span>

<span data-ttu-id="e13aa-156">チャーン分析は、さまざまなビジネスの領域に適用されます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-156">Churn analysis applies to different business areas.</span></span> <span data-ttu-id="e13aa-157">この例では、特に上記のホテル サービスのコンテキストで、サービス チャーンについて説明します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-157">In this example, we’re going to look at service churn, specifically in the context of hotel services as described above.</span></span> <span data-ttu-id="e13aa-158">他のタイプのチャーン モデルの開始点として使用できるエンドツーエンド モデル パイプラインの実用例を提供します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-158">It provides a working example of an end–to–end model pipeline that can be used as a starting point for any other type of churn model.</span></span>

### <a name="definition-of-churn"></a><span data-ttu-id="e13aa-159">チャーンの定義</span><span class="sxs-lookup"><span data-stu-id="e13aa-159">Definition of Churn</span></span>

<span data-ttu-id="e13aa-160">チャーンの定義は、シナリオによって異なる場合があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-160">The definition of churn can differ based on the scenario.</span></span> <span data-ttu-id="e13aa-161">この例では、過去 1 年間ホテルを利用していないゲストには、チャーンのラベルが表示されているはずです。</span><span class="sxs-lookup"><span data-stu-id="e13aa-161">In this example, a guest who hasn’t visited the hotel in the past year should be labeled as churned.</span></span>  

<span data-ttu-id="e13aa-162">実験のテンプレートは、ギャラリーからインポートできます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-162">The experiment template can be imported from the gallery.</span></span> <span data-ttu-id="e13aa-163">まず、**ホテル滞在アクティビティ**、**顧客データ**、**サービス利用データ** のデータを Azure Blob Storage からインポートしていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-163">First, ensure that you import the data for **Hotel Stay Activity**, **Customer data**, and **Service Usage Data** from Azure Blob storage.</span></span>

   ![チャーンのモデルに使用するデータをインポートする](media/import-data-azure-blob-storage.png)

### <a name="featurization"></a><span data-ttu-id="e13aa-165">特性付け</span><span class="sxs-lookup"><span data-stu-id="e13aa-165">Featurization</span></span>

<span data-ttu-id="e13aa-166">チャーンの定義に基づいて、まずラベルに影響を与える生の特徴を特定します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-166">Based on the definition of churn, we first identify the raw features that will influence the label.</span></span> <span data-ttu-id="e13aa-167">そして、これらの原素材の特徴を機械学習モデルで利用できる数値特徴に加工します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-167">Then, we process these raw features into numerical features that can be used with machine learning models.</span></span> <span data-ttu-id="e13aa-168">データ統合は、Customer Insights で行われるため、*顧客 ID* を使用して、これらのテーブルを結合できます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-168">Data integration happens in Customer Insights so we can join these tables by using the *Customer ID*.</span></span>

   ![インポートされたレコードの結合](media/join-imported-data.png)

<span data-ttu-id="e13aa-170">チャーン分析のモデルを構築するための特性付けには、少し注意が必要です。</span><span class="sxs-lookup"><span data-stu-id="e13aa-170">The featurization for building the model for churn analysis can be a little tricky.</span></span> <span data-ttu-id="e13aa-171">データは時間の関数であり、新しいホテルのアクティビティが毎日記録されます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-171">The data is a function of time with new hotel activity recorded on daily basis.</span></span> <span data-ttu-id="e13aa-172">特性付けの際には、動的データから静的機能を生成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-172">During featurization, we want to generate static features from the dynamic data.</span></span> <span data-ttu-id="e13aa-173">この場合、1 年のスライディング ウィンドウを使用して、ホテルの活動から複数の機能を生成します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-173">In this case, we generate multiple features from hotel activity with a sliding window of one year.</span></span> <span data-ttu-id="e13aa-174">また、部屋タイプや予約タイプなどのカテゴリ機能を、ワンホット エンコーディングを使用してで別の機能に拡張します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-174">We also expand the categorical features like room type or booking type into separate features using one-hot encoding.</span></span>  

<span data-ttu-id="e13aa-175">機能の最終リスト :</span><span class="sxs-lookup"><span data-stu-id="e13aa-175">Final list of features:</span></span>

| <span data-ttu-id="e13aa-176">**番号**</span><span class="sxs-lookup"><span data-stu-id="e13aa-176">**Number**</span></span>  | <span data-ttu-id="e13aa-177">**Original_Column**</span><span class="sxs-lookup"><span data-stu-id="e13aa-177">**Original_Column**</span></span>          | <span data-ttu-id="e13aa-178">**派生機能**</span><span class="sxs-lookup"><span data-stu-id="e13aa-178">**Derived Features**</span></span>                                                                                                                      |
|-------------|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e13aa-179">1</span><span class="sxs-lookup"><span data-stu-id="e13aa-179">1</span></span>           | <span data-ttu-id="e13aa-180">部屋タイプ</span><span class="sxs-lookup"><span data-stu-id="e13aa-180">Room Type</span></span>                    | <span data-ttu-id="e13aa-181">RoomTypeLargeCount、RoomTypeSmallCount</span><span class="sxs-lookup"><span data-stu-id="e13aa-181">RoomTypeLargeCount, RoomTypeSmallCount</span></span>                                                                                                    |
| <span data-ttu-id="e13aa-182">2</span><span class="sxs-lookup"><span data-stu-id="e13aa-182">2</span></span>           | <span data-ttu-id="e13aa-183">予約の種類</span><span class="sxs-lookup"><span data-stu-id="e13aa-183">Booking Type</span></span>                 | <span data-ttu-id="e13aa-184">BookingTypeOnlineCount、BookingTypePhoneCallCount</span><span class="sxs-lookup"><span data-stu-id="e13aa-184">BookingTypeOnlineCount, BookingTypePhoneCallCount</span></span>                                                                                         |
| <span data-ttu-id="e13aa-185">3</span><span class="sxs-lookup"><span data-stu-id="e13aa-185">3</span></span>           | <span data-ttu-id="e13aa-186">旅行カテゴリー</span><span class="sxs-lookup"><span data-stu-id="e13aa-186">Travel Category</span></span>              | <span data-ttu-id="e13aa-187">TravelCategoryBusinessCount、TravelCategoryLeisureCount</span><span class="sxs-lookup"><span data-stu-id="e13aa-187">TravelCategoryBusinessCount, TravelCategoryLeisureCount</span></span>                                                                                   |
| <span data-ttu-id="e13aa-188">4</span><span class="sxs-lookup"><span data-stu-id="e13aa-188">4</span></span>           | <span data-ttu-id="e13aa-189">使用されたドル</span><span class="sxs-lookup"><span data-stu-id="e13aa-189">Dollars Spent</span></span>                | <span data-ttu-id="e13aa-190">TotalDollarSpent</span><span class="sxs-lookup"><span data-stu-id="e13aa-190">TotalDollarSpent</span></span>                                                                                                                          |
| <span data-ttu-id="e13aa-191">5</span><span class="sxs-lookup"><span data-stu-id="e13aa-191">5</span></span>           | <span data-ttu-id="e13aa-192">チェックイン日付とチェックアウト日付</span><span class="sxs-lookup"><span data-stu-id="e13aa-192">Check-in and Checkout dates</span></span>  | <span data-ttu-id="e13aa-193">StayDayCount、StayDayCount2016、StayDayCount2015、StayDayCount2014、StayCount、StayCount2016。</span><span class="sxs-lookup"><span data-stu-id="e13aa-193">StayDayCount, StayDayCount2016, StayDayCount2015, StayDayCount2014, StayCount, StayCount2016.</span></span> <span data-ttu-id="e13aa-194">StayCount2015、StayCount2014</span><span class="sxs-lookup"><span data-stu-id="e13aa-194">StayCount2015, StayCount2014</span></span>                |
| <span data-ttu-id="e13aa-195">6</span><span class="sxs-lookup"><span data-stu-id="e13aa-195">6</span></span>           | <span data-ttu-id="e13aa-196">サービスの使用率</span><span class="sxs-lookup"><span data-stu-id="e13aa-196">Service Usage</span></span>                | <span data-ttu-id="e13aa-197">UsageTenure、ConciergeUsage、CourierUsage、DryCleaningUsage、GymUsage、PhoneUsage、RestaurantUsage、SpaUsage、TelevisionUsage、WifiUsage</span><span class="sxs-lookup"><span data-stu-id="e13aa-197">UsageTenure, ConciergeUsage, CourierUsage, DryCleaningUsage, GymUsage, PhoneUsage, RestaurantUsage, SpaUsage, TelevisionUsage, WifiUsage</span></span>  |

### <a name="model-selection"></a><span data-ttu-id="e13aa-198">モデルの選択</span><span class="sxs-lookup"><span data-stu-id="e13aa-198">Model selection</span></span>

<span data-ttu-id="e13aa-199">次に、使用する最適なアルゴリズムを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-199">Now we need to choose the optimal algorithm to use.</span></span> <span data-ttu-id="e13aa-200">この場合、ほとんどの機能はカテゴリの機能に基づいています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-200">In this case, most features are based on categorical features.</span></span> <span data-ttu-id="e13aa-201">通常、デシジョン ツリー ベースのモデルがうまく機能します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-201">Typically, decision tree–based models work well.</span></span> <span data-ttu-id="e13aa-202">数値的特徴しかない場合は、ニューラル ネットワークの方が良いかもしれません。</span><span class="sxs-lookup"><span data-stu-id="e13aa-202">If there are only numerical features, neural networks could be a better choice.</span></span> <span data-ttu-id="e13aa-203">このような状況では、サポート ベクター マシン (SVM) も適していますが、最高のパフォーマンスを引き出すためには、多くのチューニングが必要となります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-203">Support vector machine (SVM) also is a good candidate in such situations; however, it needs quite a bit of tuning to extract the best performance.</span></span> <span data-ttu-id="e13aa-204">第 1 の選択モデルとして **2 クラスの増幅デシジョン ツリー** を選択し、第 2 の選択モデルとして **2 クラスの SVM** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-204">We choose **Two-Class Boosted Decision Tree** as the first model of choice followed by **Two-Class SVM** as the second model.</span></span> <span data-ttu-id="e13aa-205">Azure Machine Learning Studio を使用すると、A/B テストを実行できるため、1 つではなく 2 つのモデルから開始することを推奨します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-205">Azure Machine Learning Studio lets you do A/B testing, so it’s beneficial to start with two models rather than one.</span></span>

<span data-ttu-id="e13aa-206">次の画像は、Azure Machine Learning Studio におけるモデルのトレーニングと評価のパイプラインを示しています :</span><span class="sxs-lookup"><span data-stu-id="e13aa-206">The following image shows the model training and evaluation pipeline from Azure Machine Learning Studio:</span></span>

![Azure Machine Learning Studio のチャーン モデル](media/azure-machine-learning-model.png)

<span data-ttu-id="e13aa-208">また、モデル最適化の重要な側面である **順列の特徴量の重要度** と呼ばれる手法を適用します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-208">We also apply a technique called **Permutation Feature Importance**, an important aspect of model optimization.</span></span> <span data-ttu-id="e13aa-209">組み込みモデルは、最終的な予測に対する特定の特徴量の影響についての分析情報をほとんど有しません。</span><span class="sxs-lookup"><span data-stu-id="e13aa-209">Built-in models have little to no insight into the impact of any specific feature on the final prediction.</span></span> <span data-ttu-id="e13aa-210">特徴量の重要度計算機は、特定のモデルの結果に対する個々の特徴量の影響を計算するためにカスタム アルゴリズムを使用しています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-210">The feature importance calculator uses a custom algorithm to compute the influence of individual features on the outcome for a specific model.</span></span> <span data-ttu-id="e13aa-211">特徴量の重要度は +1 から -1 の範囲で正規化されます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-211">The feature importance is normalized between +1 to -1.</span></span> <span data-ttu-id="e13aa-212">マイナスの影響は、対応する特徴量が結果に反直観的な影響を及ぼしており、モデルから削除する必要があることを意味します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-212">A negative influence means the corresponding feature has counter-intuitive influence on the outcome and should be removed from the model.</span></span> <span data-ttu-id="e13aa-213">ポジティブな影響は、特徴量が予測に大きく貢献していることを示します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-213">A positive influence indicates the feature is contributing heavily towards the prediction.</span></span> <span data-ttu-id="e13aa-214">これらの値は異なるメトリックであるため、相関係数とは見なされません。</span><span class="sxs-lookup"><span data-stu-id="e13aa-214">These values aren't correlation coefficients as they are different metrics.</span></span> <span data-ttu-id="e13aa-215">詳細については、[順列の特徴量の重要度](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/permutation-feature-importance) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e13aa-215">For more information, see [Permutation Feature Importance](https://docs.microsoft.com/azure/machine-learning/studio-module-reference/permutation-feature-importance).</span></span>

<span data-ttu-id="e13aa-216">全体的な [チャーンの実験は Azure AI Gallery で利用できます](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp)。</span><span class="sxs-lookup"><span data-stu-id="e13aa-216">The entire [churn experiment is available in the Azure AI Gallery](https://gallery.azure.ai/Experiment/Hotel-Churn-Predictive-Exp).</span></span>

## <a name="customer-lifetime-value-prediction"></a><span data-ttu-id="e13aa-217">顧客の生涯価値予測</span><span class="sxs-lookup"><span data-stu-id="e13aa-217">Customer lifetime value prediction</span></span>

<span data-ttu-id="e13aa-218">顧客の生涯価値 (CLTV) の算出は、企業が顧客を評価し、セグメント化するにあたっての重要なメトリックの 1 つです。</span><span class="sxs-lookup"><span data-stu-id="e13aa-218">The customer lifetime value (CLTV) calculation is one of the key metrics that a business can use to assess and segment its customers.</span></span> <span data-ttu-id="e13aa-219">ホテル ビジネスでは、顧客を知ることが重要となります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-219">For the hotel business, it’s critical to know their customers.</span></span> <span data-ttu-id="e13aa-220">たとえば、良い顧客を構成する要素を理解することは重要な情報です。</span><span class="sxs-lookup"><span data-stu-id="e13aa-220">For example, understanding factors that make up good customers is crucial information.</span></span> <span data-ttu-id="e13aa-221">これにより、ホテルの経営者が、高い金額を払ってくれる顧客を満足させるためにどの機能に焦点を当て、改善する必要があるかを評価する際に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-221">It helps the hotel management assess which features they need to focus on and improve to satisfy their high paying customers.</span></span> <span data-ttu-id="e13aa-222">これらの決定は、売上と収益に直接影響を与える可能性があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-222">These decisions can have a direct impact on sales and earnings.</span></span>  

### <a name="definition-of-cltv"></a><span data-ttu-id="e13aa-223">CLTV の定義</span><span class="sxs-lookup"><span data-stu-id="e13aa-223">Definition of CLTV</span></span>

<span data-ttu-id="e13aa-224">この例では、顧客の CLTV を、顧客が今後 365 日間に消費すると予想される総ドル額と定義しています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-224">For this example, we define the CLTV of a customer as the total dollar amount the customer is expected to spend in the next 365 days.</span></span> <span data-ttu-id="e13aa-225">過去 3 年分のデータを使って、すべての顧客に対するこの価値を予測します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-225">We are going to use the past three years’ worth of data for all customers to predict this value.</span></span>

### <a name="featurization"></a><span data-ttu-id="e13aa-226">特性付け</span><span class="sxs-lookup"><span data-stu-id="e13aa-226">Featurization</span></span>

<span data-ttu-id="e13aa-227">この場合、特徴付けはチャーンのシナリオと非常に共通しています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-227">In this case, featurization is going to be quite like the churn scenario.</span></span> <span data-ttu-id="e13aa-228">ただし、ラベルと予測値は上記で定義したものとは異なります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-228">However, the labels and predicted values are different than defined above.</span></span>

### <a name="model-selection"></a><span data-ttu-id="e13aa-229">モデルの選択</span><span class="sxs-lookup"><span data-stu-id="e13aa-229">Model selection</span></span>

<span data-ttu-id="e13aa-230">CLTV の予測は、予測値が正の値の連続型変数であるため、回帰問題となります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-230">Predicting the CLTV is a regression problem as the predicted value is a positive valued continuous variable.</span></span> <span data-ttu-id="e13aa-231">機能のプロパティに基づいて、モデルをトレーニングするための、1 つのアルゴリズムとして **増幅デシジョン ツリー回帰** を、もう 1 つのアルゴリズムとして **ニューラル ネットワーク回帰** を選択します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-231">Based on the feature properties, we select **Boosted Decision Tree Regression** as one algorithm and **Neural Network Regression** as another algorithm to train the model.</span></span>

## <a name="product-recommendation-or-next-best-action"></a><span data-ttu-id="e13aa-232">製品推奨、または次のベスト アクション</span><span class="sxs-lookup"><span data-stu-id="e13aa-232">Product recommendation or Next Best Action</span></span>

<span data-ttu-id="e13aa-233">ホテルのシナリオにおける製品の推奨は、ホテルが顧客に提供する推奨サービスとして解釈されます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-233">Product recommendation in a hotel scenario is interpreted as recommending services offered by the hotel to the customers.</span></span> <span data-ttu-id="e13aa-234">目的は、顧客に最適なサービスを選択して、その利用を最大化することです。</span><span class="sxs-lookup"><span data-stu-id="e13aa-234">The objective is to choose the appropriate services for customers so that their usage is maximized.</span></span> <span data-ttu-id="e13aa-235">これは、ビデオ ストリーミング サービスのユーザーに向けて、映画を推薦することに似ています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-235">It’s similar to movie recommendations for video streaming service users.</span></span>

### <a name="definition-of-product-recommendation-or-next-best-action"></a><span data-ttu-id="e13aa-236">製品の推奨、または次善の策についての定義</span><span class="sxs-lookup"><span data-stu-id="e13aa-236">Definition of Product Recommendation or Next Best Action</span></span>

<span data-ttu-id="e13aa-237">目的に応じて、ホテルの顧客に最適なマッチング サービスを提供することで、サービスの利用額を最大化することを目標としています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-237">We define the goal as maximizing the dollar amount of service usage by offering the best matching services to hotel customers according to their interest.</span></span>

### <a name="featurization"></a><span data-ttu-id="e13aa-238">特性付け</span><span class="sxs-lookup"><span data-stu-id="e13aa-238">Featurization</span></span>

<span data-ttu-id="e13aa-239">チャーンモデルと同様に、ホテルの ServiceCustomerID と CustomerID を結合し、CustomerID ごとに一貫した推奨事項を構築しています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-239">Like the churn model, we are joining the hotel ServiceCustomerID with CustomerID in order to build recommendations consistently per CustomerID.</span></span>

![推奨モデルの特性付け](media/azure-machine-learning-model-featurization.png)

<span data-ttu-id="e13aa-241">データは 3 つの異なるエンティティをソースにしており、そこから特徴を派生させています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-241">The data is sourced from three different entities and features are derived from them.</span></span> <span data-ttu-id="e13aa-242">推奨の問題に対する特徴付けは、チャーンや CLTV のシナリオとは異なります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-242">The featurization for the problem of recommendation is different compared to churn or CLTV scenarios.</span></span> <span data-ttu-id="e13aa-243">推奨モデルには、3 つの機能セットの形式で入力データが必要となります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-243">The recommendation model needs input data in the form of three sets of features.</span></span>

### <a name="model-selection"></a><span data-ttu-id="e13aa-244">モデルの選択</span><span class="sxs-lookup"><span data-stu-id="e13aa-244">Model selection</span></span>

<span data-ttu-id="e13aa-245">**マッチボックス レコメンダーのトレーニング** と呼ばれるアルゴリズムを用いて、製品やサービスを予測し、推奨モデルをトレーニングします。</span><span class="sxs-lookup"><span data-stu-id="e13aa-245">We predict products or services by using the algorithm called **Train Matchbox Recommender** to train the recommendation model.</span></span>

![製品推奨のアルゴリズム](media/azure-machine-learning-model-recommendation-algorithm.png)

<span data-ttu-id="e13aa-247">**マッチボックス レコメンダーのトレーニング** モデルに使用されるの 3 つの入力ポートは、トレーニング サービスの利用データ、顧客説明 (オプション)、サービス説明を取り込みます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-247">The three input ports for the **Train Matchbox Recommender** model takes in the training service usage data, customer description (optional), and service description.</span></span> <span data-ttu-id="e13aa-248">モデルのスコアリングには 3 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-248">There are three different ways of scoring the model.</span></span> <span data-ttu-id="e13aa-249">1 つは、正規化された割引累積ゲイン (NDCG) スコアを計算して、評価されたアイテムをランク付けするモデル評価用です。</span><span class="sxs-lookup"><span data-stu-id="e13aa-249">One is for model evaluation where a Normalized Discounted Cumulative Gain (NDCG) score is calculated to rank the rated items.</span></span> <span data-ttu-id="e13aa-250">この実験では、NDCG スコアは 0.97 となっています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-250">In this experiment, we have the NDCG score as 0.97.</span></span> <span data-ttu-id="e13aa-251">その他 2 つのオプションは、推奨可能なサービス カタログ全体でモデルを採点するか、ユーザーが以前に使用したことのない項目のみを採点するものです。</span><span class="sxs-lookup"><span data-stu-id="e13aa-251">The other two options are scoring the model on the entire recommendable service catalog, or scoring only on items that users have not used before.</span></span>

<span data-ttu-id="e13aa-252">さらにサービス カタログ全体での推奨分布を見てみると、電話、WiFi、宅配便が推奨度の上位を占めていることがわかります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-252">Looking further on the distributions of the recommendations on the entire service catalog, we notice that phone, WiFi, and courier are the top services to be recommended.</span></span> <span data-ttu-id="e13aa-253">これは、サービスの消費データの分布から得られるものと一致しています。</span><span class="sxs-lookup"><span data-stu-id="e13aa-253">This is consistent with what we found from the distributions of the service consumption data:</span></span>

![推奨モデルの結果](media/azure-machine-learning-model-output.png)

<span data-ttu-id="e13aa-255">全体的な [製品推奨の実験は、Azure AI Gallery でアクセスできます。](https://gallery.azure.ai/Experiment/Recommendation-4)</span><span class="sxs-lookup"><span data-stu-id="e13aa-255">The entire [product recommendation experiment can be accessed in Azure AI Gallery.](https://gallery.azure.ai/Experiment/Recommendation-4)</span></span>

## <a name="integrate-custom-models"></a><span data-ttu-id="e13aa-256">カスタム モデルの統合</span><span class="sxs-lookup"><span data-stu-id="e13aa-256">Integrate custom models</span></span>

<span data-ttu-id="e13aa-257">Customer Insights でこれらの予測を使用するには、顧客 ID と共に予測値を **エクスポート** する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e13aa-257">To use these predictions in Customer Insights, you need to **export** the predictions along with the customer IDs.</span></span> <span data-ttu-id="e13aa-258">ソース データをエクスポートするのと [同じ Azure Blob Storage の場所にエクスポート](https://docs.microsoft.com/azure/storage/common/storage-import-export-data-from-blobs) します。</span><span class="sxs-lookup"><span data-stu-id="e13aa-258">[Export them to the same Azure Blob storage location](https://docs.microsoft.com/azure/storage/common/storage-import-export-data-from-blobs) that you export the source data to.</span></span> <span data-ttu-id="e13aa-259">予測 Webサービスは、定期的に実行してスコアを更新するようにスケジュール設定することができます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-259">The predictive web service can be scheduled to run regularly and update the scores.</span></span>

<span data-ttu-id="e13aa-260">カスタム モデルで生成されたデータを使用して、顧客データをさらに強化させることができます。</span><span class="sxs-lookup"><span data-stu-id="e13aa-260">Data generated by the custom model can be used to further enrich your customer data.</span></span> <span data-ttu-id="e13aa-261">詳細については、[カスタム機械学習モデル](custom-models.md) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="e13aa-261">For more information, see [Custom machine learning models](custom-models.md).</span></span>
